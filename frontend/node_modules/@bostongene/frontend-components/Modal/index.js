"use strict";
var __importStar = (this && this.__importStar) || function (mod) {
    if (mod && mod.__esModule) return mod;
    var result = {};
    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];
    result["default"] = mod;
    return result;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
var react_1 = __importStar(require("react"));
var react_dom_1 = __importDefault(require("react-dom"));
var classnames_1 = __importDefault(require("classnames"));
require("./Modal.scss");
var Modal = function (_a) {
    var _b;
    var className = _a.className, visible = _a.visible, onClose = _a.onClose, children = _a.children;
    var modalRef = react_1.useRef(null);
    var overflowRef = react_1.useRef(null);
    var listenKeyboard = function (event) {
        if (event.keyCode === 27)
            onClose();
    };
    var contentClasses = classnames_1.default((_b = {
            'bg-modal__content': true
        },
        _b[className] = className,
        _b));
    react_1.useLayoutEffect(function () {
        var _a;
        if (visible) {
            overflowRef.current = document.body.style.overflow;
            document.body.style.overflow = 'hidden';
            (_a = modalRef.current) === null || _a === void 0 ? void 0 : _a.focus();
        }
        else {
            document.body.style.overflow = overflowRef.current;
        }
    }, [visible]);
    return visible
        ? react_dom_1.default.createPortal(react_1.default.createElement("div", { className: "bg-modal", ref: modalRef, tabIndex: -1, onKeyDown: listenKeyboard },
            react_1.default.createElement("div", { className: "bg-modal__overlay", onClick: onClose }),
            react_1.default.createElement("svg", { xmlns: "http://www.w3.org/2000/svg", width: "13", height: "13", viewBox: "0 0 13 13", className: "bg-modal__close-icon", onClick: onClose },
                react_1.default.createElement("g", { fill: "none", fillRule: "evenodd" },
                    react_1.default.createElement("path", { d: "M-6-6h24v24H-6z" }),
                    react_1.default.createElement("path", { fill: "#fff", d: "M11.892.642a.907.907 0 0 0-1.284 0L6.117 5.133 1.625.642A.907.907 0 1 0 .342 1.925l4.491 4.492-4.491 4.491a.907.907 0 1 0 1.283 1.283L6.117 7.7l4.491 4.492a.907.907 0 0 0 1.283-1.283L7.4 6.416l4.492-4.492a.907.907 0 0 0 0-1.283z" }))),
            react_1.default.createElement("div", { className: contentClasses }, children)), document.body)
        : null;
};
Modal.defaultProps = {
    className: ''
};
exports.default = react_1.memo(Modal);
